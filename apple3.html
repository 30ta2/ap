<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
  <title>每日時間提醒表 PWA</title>
  <meta name="theme-color" content="#E3F2FD"/>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="apple-touch-icon" sizes="180x180" href="icon-180.png">
  <style>
    :root {
      --primary: #42A5F5;
      --primary-dark: #1976D2;
      --accent: #80CBC4;
      --accent-sleep: #7986CB;
      --bg: #E3F2FD;
      --card: #FFF;
      --danger: #EF5350;
      --text: #46505A;
      --muted: #90A4AE;
      --radius: 16px;
      --shadow: 0 8px 18px 0 rgba(44,62,80,0.06);
      --space: 18px;
      --space-xs: 8px;
      --space-sm: 12px;
      --transition: 0.18s cubic-bezier(.42,1.5,.41,.8);
      --alert-anim: alertPulse 1.2s infinite cubic-bezier(.8,0,.18,1);
    }
    html,body{height:100%;margin:0;padding:0;font-size:17px;}
    body{
      background:var(--bg);
      color:var(--text);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      margin:0; padding:0;
      min-height:100vh; display:flex; flex-direction:column; align-items:center;
    }
    .container{
      width:100vw; max-width:420px; padding:var(--space-xs) var(--space); margin:auto;
      box-sizing:border-box;
    }
    header{ text-align:center; margin:var(--space); }
    h1{ color:var(--primary); margin:0 0 var(--space-xs) 0; font-size:1.5em;}
    .hint{ color:var(--muted); font-size:0.93em; text-align:center; margin-top:10px;}
    .nowtime{
      text-align:center;
      font-weight:600;
      color:var(--primary-dark);
      font-size:2rem;
      letter-spacing:1.5px;
      margin:0 0 var(--space-xs) 0;
      user-select:none;
      transition:color var(--transition);
    }
    .nowdate{
      text-align:center;
      font-weight:400;
      color:var(--muted);
      font-size:1.07em;
      letter-spacing:1px;
      margin-bottom:var(--space-xs);
      user-select:none;
    }
    .card{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:var(--space-sm);
      margin-bottom:var(--space-xs);
      font-size:1.09em;
      animation:fadeIn 0.5s;
      transition:box-shadow 0.25s;
    }
    .highlight{
      border:2.5px solid var(--primary);
      background:var(--accent);
      color:#222;
      position:relative;
      box-shadow:0 0 0 2px #b6dafd;
    }
    .highlight.sleep {
      border:2.5px solid var(--accent-sleep);
      background:rgba(121, 134, 203, 0.12);
      color:var(--text);
      box-shadow:0 0 0 2px var(--accent-sleep);
    }
    .alert-effect {
      animation: var(--alert-anim);
      box-shadow: 0 0 0 4px #ef535082,0 0 17px 1px #f44336,0 0 4px 2px #90caf9a8;
      border-color:#f44336;
    }
    @keyframes alertPulse {
      0% { box-shadow: 0 0 0 4px #ef535082, 0 0 10px #f44336, 0 0 4px 2px #90caf9a8;}
      50% { box-shadow: 0 0 0 6px #f4433624, 0 0 12px #1976D2BB, 0 0 7px 2px #42A5F583;}
      100% { box-shadow: 0 0 0 4px #ef535082, 0 0 17px 1px #f44336, 0 0 4px 2px #90caf9a8;}
    }
    .schedule-list{
      margin-top:var(--space-xs);
      padding:0; list-style:none;
    }
    .schedule-item{
      margin-bottom:var(--space-xs);
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:12px 14px;
      font-size:1em;
      transition:background var(--transition), box-shadow var(--transition);
    }
    .schedule-item.current{
      background:var(--primary);
      color:#fff;
      box-shadow:0 6px 24px 0 rgba(66,165,245,0.08);
      font-weight:bold;
      letter-spacing:0.6px;
      animation:highlight 0.8s;
    }
    .schedule-item.sleep{
      background:var(--accent-sleep);
      color:#fff;
      font-weight:bold;
    }
    .schedule-item.sleep.current {
      animation:highlightSleep 0.8s;
    }
    @keyframes highlight {
      0% { background: var(--accent); color: #333;}
      100% { background: var(--primary); color: #fff;}
    }
    @keyframes highlightSleep {
      0% { background: var(--accent); color: #333;}
      100% { background: var(--accent-sleep); color: #fff;}
    }
    @media (max-width:600px){
      .container{padding:7px;}
      .nowtime{font-size:1.5rem;}
    }
    @keyframes fadeIn {from{opacity:0;}to{opacity:1;}}
  </style>
  <script>
    if('serviceWorker' in navigator){navigator.serviceWorker.register('sw.js');}
  </script>
</head>
<body>
<div class="container">
  <header>
    <h1>⏰ 每日時間提醒表</h1>
  </header>
  <div class="nowdate" id="nowdate">--</div>
  <div class="nowtime" id="nowtime">--:--:--</div>
  <div class="card highlight" id="card-current">
    <div id="current-slot"><span style="font-weight:600;">此刻</span>：--:-- - --:--</div>
    <div id="current-task" style="margin-top:6px;"></div>
  </div>
  <ul class="schedule-list" id="schedule-list"></ul>
</div>
<script>
  const schedule = [
    {start:"05:30", end:"06:00", task:"掃描身體-整理環境-刷牙洗臉-買早餐"},
    {start:"06:00", end:"07:00", task:"吃早餐-手機自由"},
    {start:"07:00", end:"11:00", task:"每日任務"},
    {start:"11:00", end:"12:00", task:"整理總結-吃午餐"},
    {start:"12:00", end:"13:00", task:"午休-手機自由-客源-虛擬商品"},
    {start:"13:00", end:"16:00", task:"刺青技巧複習整合規劃"},
    {start:"16:00", end:"17:00", task:"運動-拳擊"},
    {start:"17:00", end:"18:00", task:"晚餐"},
    {start:"18:00", end:"19:00", task:"休息"},
    {start:"19:00", end:"20:00", task:"口腔-語言-聲音-女生-穿著-拍片-表情-體態"},
    {start:"20:00", end:"21:00", task:"環境整理-復盤-打掃-洗澡"},
    {start:"21:00", end:"22:00", task:"看書-默寫-規劃明天"},
    {start:"22:00", end:"05:30", task:"準時就寢&充能", isSleep:true}
  ];
  function pad(n){return n.toString().padStart(2,"0");}
  function weekText(n) {
    return ["日","一","二","三","四","五","六"][n];
  }
  function timeToMins(str){
    const [h,m]=str.split(":").map(Number);return h*60+m;
  }
  function getCurrentSlot(now){
    const mins = now.getHours()*60+now.getMinutes();
    let currIdx=-1;
    schedule.forEach((item,i)=>{
      if(item.isSleep) {
        // 22:00 - 05:30 跨天邏輯
        const startMins = timeToMins(item.start);
        if(mins>=startMins || mins<timeToMins(item.end)) currIdx=i;
      } else {
        if(mins>=timeToMins(item.start)&&mins<timeToMins(item.end)) currIdx=i;
      }
    });
    return currIdx;
  }
  function render(){
    // nowdate
    const now = new Date();
    const dateStr = now.getFullYear()+"-"+pad(now.getMonth()+1)+"-"+pad(now.getDate())
      +" 星期"+weekText(now.getDay());
    document.getElementById("nowdate").textContent = dateStr;
    // 現在時間精確到秒
    document.getElementById("nowtime").textContent = pad(now.getHours())+":"+pad(now.getMinutes())+":"+pad(now.getSeconds());
    // 目前時段判定
    const idx = getCurrentSlot(now);
    const currEl = document.getElementById("card-current");
    if(idx>-1){
      const item = schedule[idx];
      // 框效果
      currEl.className = "card highlight";
      if(item.isSleep) currEl.classList.add("sleep");
      currEl.classList.add("alert-effect");
      document.getElementById("current-slot").innerHTML = `<span style='font-weight:600;'>此刻</span>：${item.start} – ${item.end}`;
      document.getElementById("current-task").textContent = item.task;
    } else {
      currEl.className = "card highlight";
      document.getElementById("current-slot").innerHTML = `<span style='font-weight:600;'>此刻</span>：--:-- – --:--`;
      document.getElementById("current-task").textContent = "";
    }
    // 渲染整天表
    const ul = document.getElementById("schedule-list");
    ul.innerHTML="";
    schedule.forEach((slot,i)=>{
      const li = document.createElement("li");
      li.className="schedule-item";
      if(i===idx) {
        li.classList.add("current");
        if(slot.isSleep) li.classList.add("sleep");
      } else if(slot.isSleep) {
        li.classList.add("sleep");
      }
      li.innerHTML = `<div style="font-weight:600">${slot.start} – ${slot.end}</div><div>${slot.task}</div>`;
      ul.appendChild(li);
    });
  }
  render(); setInterval(render,300); // 動畫與秒顯示
</script>
</body>
</html>
